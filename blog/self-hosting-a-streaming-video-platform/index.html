<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>Self-hosting a streaming video platform</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="preload" href="/assets/css/app.css?v=d450aebd8c" as="style" />
    <link rel="preload" href="/assets/css/prism.css?v=d450aebd8c" as="style" />
    <link rel="preload" href="/assets/js/manifest.js?v=d450aebd8c" as="script" />
    <link rel="preload" href="/assets/js/vendor/content-api.min.js?v=d450aebd8c" as="script" />
    <link rel="preload" href="/assets/js/vendor.js?v=d450aebd8c" as="script" />
    <link rel="preload" href="/assets/js/app.js?v=d450aebd8c" as="script" />
    <link rel="preload" href="/assets/js/prism.js?v=d450aebd8c" as="script" />
    <link rel="preconnect" href="https://polyfill.io">
    <link rel="dns-prefetch" href="https://polyfill.io">

      <link rel="preload" href="/assets/css/post.css?v=d450aebd8c" as="style" />
  <link rel="preload" href="/assets/js/post.js?v=d450aebd8c" as="script" />


    <style>
      /* These font-faces are here to make fonts work if the Ghost instance is installed in a subdirectory */

      /* source-sans-pro-regular */
      @font-face {
        font-family: 'Source Sans Pro';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: local('Source Sans Pro Regular'), local('SourceSansPro-Regular'),
            url("/assets/fonts/source-sans-pro/source-sans-pro-regular.woff2?v=d450aebd8c") format('woff2'),
            url("/assets/fonts/source-sans-pro/source-sans-pro-regular.woff?v=d450aebd8c") format('woff');
      }

      /* source-sans-pro-600 */
      @font-face {
        font-family: 'Source Sans Pro';
        font-style: normal;
        font-weight: 600;
        font-display: swap;
        src: local('Source Sans Pro SemiBold'), local('SourceSansPro-SemiBold'),
            url("/assets/fonts/source-sans-pro/source-sans-pro-600.woff2?v=d450aebd8c") format('woff2'),
            url("/assets/fonts/source-sans-pro/source-sans-pro-600.woff?v=d450aebd8c") format('woff');
      }

      /* source-sans-pro-700 */
      @font-face {
        font-family: 'Source Sans Pro';
        font-style: normal;
        font-weight: 700;
        font-display: swap;
        src: local('Source Sans Pro Bold'), local('SourceSansPro-Bold'),
            url("/assets/fonts/source-sans-pro/source-sans-pro-700.woff2?v=d450aebd8c") format('woff2'),
            url("/assets/fonts/source-sans-pro/source-sans-pro-700.woff?v=d450aebd8c") format('woff');
      }

      /* iconmoon */
      @font-face {
        font-family: 'icomoon';
        font-weight: normal;
        font-style: normal;
        font-display: swap;
        src: url("/assets/fonts/icomoon/icomoon.eot?aoz2mo?v=d450aebd8c");
        src: url("/assets/fonts/icomoon/icomoon.eot?aoz2mo#iefix?v=d450aebd8c") format('embedded-opentype'),
        url("/assets/fonts/icomoon/icomoon.ttf?aoz2mo?v=d450aebd8c") format('truetype'),
        url("/assets/fonts/icomoon/icomoon.woff?aoz2mo?v=d450aebd8c") format('woff'),
        url("/assets/fonts/icomoon/icomoon.svg?aoz2mo#icomoon?v=d450aebd8c") format('svg');
      }
    </style>

    <link rel="stylesheet" type="text/css" href="/assets/css/app.css?v=d450aebd8c" media="screen" />
    <link rel="stylesheet" type="text/css" href="/assets/css/prism.css?v=d450aebd8c" media="screen" />

      <link rel="stylesheet" type="text/css" href="/assets/css/post.css?v=d450aebd8c" media="screen" />


      <style>
    .m-hero__picture {
      background-image: url(https://images.unsplash.com/photo-1478720568477-152d9b164e26?ixlib&#x3D;rb-1.2.1&amp;q&#x3D;80&amp;fm&#x3D;jpg&amp;crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;w&#x3D;2000&amp;fit&#x3D;max&amp;ixid&#x3D;eyJhcHBfaWQiOjExNzczfQ);
    }
  
    @media(max-width: 1000px) {
      .m-hero__picture {
        background-image: url(https://images.unsplash.com/photo-1478720568477-152d9b164e26?ixlib&#x3D;rb-1.2.1&amp;q&#x3D;80&amp;fm&#x3D;jpg&amp;crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;w&#x3D;2000&amp;fit&#x3D;max&amp;ixid&#x3D;eyJhcHBfaWQiOjExNzczfQ);
      }
    }
  
    @media(max-width: 600px) {
      .m-hero__picture {
        background-image: url(https://images.unsplash.com/photo-1478720568477-152d9b164e26?ixlib&#x3D;rb-1.2.1&amp;q&#x3D;80&amp;fm&#x3D;jpg&amp;crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;w&#x3D;2000&amp;fit&#x3D;max&amp;ixid&#x3D;eyJhcHBfaWQiOjExNzczfQ);
      }
    }
  </style>


    <link rel="icon" href="/favicon.png" type="image/png" />
    <link rel="canonical" href="https://trycatch.dev/blog/self-hosting-a-streaming-video-platform/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    
    <meta property="og:site_name" content="trycatch.dev" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Self-hosting a streaming video platform" />
    <meta property="og:description" content="Before the pandemic began, I used to host movie nights. Since that activity became dangerous to do in person, I wanted to come up with a virtual alternative. Having set up a self-hosted video chat system, this would be an additional project that&#x27;d work alongside with the VPS-hosted, Dockerized, LDAP-secured" />
    <meta property="og:url" content="https://trycatch.dev/blog/self-hosting-a-streaming-video-platform/" />
    <meta property="og:image" content="https://images.unsplash.com/photo-1478720568477-152d9b164e26?ixlib&#x3D;rb-1.2.1&amp;q&#x3D;80&amp;fm&#x3D;jpg&amp;crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;w&#x3D;2000&amp;fit&#x3D;max&amp;ixid&#x3D;eyJhcHBfaWQiOjExNzczfQ" />
    <meta property="article:published_time" content="2020-09-12T16:25:47.000Z" />
    <meta property="article:modified_time" content="2020-09-12T16:25:47.000Z" />
    <meta property="article:tag" content="Docker" />
    <meta property="article:tag" content="Linux" />
    <meta property="article:tag" content="Self-hosting" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Self-hosting a streaming video platform" />
    <meta name="twitter:description" content="Before the pandemic began, I used to host movie nights. Since that activity became dangerous to do in person, I wanted to come up with a virtual alternative. Having set up a self-hosted video chat system, this would be an additional project that&#x27;d work alongside with the VPS-hosted, Dockerized, LDAP-secured" />
    <meta name="twitter:url" content="https://trycatch.dev/blog/self-hosting-a-streaming-video-platform/" />
    <meta name="twitter:image" content="https://images.unsplash.com/photo-1478720568477-152d9b164e26?ixlib&#x3D;rb-1.2.1&amp;q&#x3D;80&amp;fm&#x3D;jpg&amp;crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;w&#x3D;2000&amp;fit&#x3D;max&amp;ixid&#x3D;eyJhcHBfaWQiOjExNzczfQ" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Sasha" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Docker, Linux, Self-hosting" />
    <meta name="twitter:site" content="@arktronic" />
    <meta property="og:image:width" content="2000" />
    <meta property="og:image:height" content="1333" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "trycatch.dev",
        "url": "https://trycatch.dev/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://trycatch.dev/content/images/2020/08/trycatch-logo-3-2.png"
        }
    },
    "author": {
        "@type": "Person",
        "name": "Sasha",
        "url": "https://trycatch.dev/author/sasha/",
        "sameAs": []
    },
    "headline": "Self-hosting a streaming video platform",
    "url": "https://trycatch.dev/blog/self-hosting-a-streaming-video-platform/",
    "datePublished": "2020-09-12T16:25:47.000Z",
    "dateModified": "2020-09-12T16:25:47.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://images.unsplash.com/photo-1478720568477-152d9b164e26?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=2000&fit=max&ixid=eyJhcHBfaWQiOjExNzczfQ",
        "width": 2000,
        "height": 1333
    },
    "keywords": "Docker, Linux, Self-hosting",
    "description": "Before the pandemic began, I used to host movie nights. Since that activity\nbecame dangerous to do in person, I wanted to come up with a virtual\nalternative. Having set up a self-hosted video chat system\n[https://trycatch.dev/blog/self-hosting-a-video-chat-system/], this would be an\nadditional project that&#x27;d work alongside with the VPS-hosted, Dockerized,\nLDAP-secured environment described in the post linked at the beginning of this\nunnecessarily long sentence.\n\nBackground\nWhat am I ",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://trycatch.dev/"
    }
}
    </script>

    <meta name="generator" content="Ghost 4.2" />
    <link rel="alternate" type="application/rss+xml" title="trycatch.dev" href="https://trycatch.dev/rss.xml" />
    <script defer src="https://unpkg.com/@tryghost/portal@~1.1.0/umd/portal.min.js" data-ghost="https://trycatch.dev/"></script><style> .gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style>
    <style>
    :root {
    	--primary-subtle-color: #D76708;
        --link-color: #D76708;
    }
    
    body.home-template .m-hero.with-picture {
        min-height: 365px;
    }
    
    section.m-hero .m-hero__content a.m-button.filled {
        display: none;
    }
    
    section.m-subscribe-section {
        display: none;
    }
    
    [data-theme="light"] {
        --footer-background-color: #D76708;
    }
    
    [data-theme="dark"] {
        --secondary-border-color: #222;
    }
    
    .l-post-content pre code {
        color: inherit;
        background-color: inherit;
    }
    
    .l-post-content .kg-code-card figcaption {
        margin-top: -35px;
    }
</style>
<style>:root {--ghost-accent-color: #15171A;}</style>

    <script>
      // @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&dn=expat.txt Expat
      const ghostHost = "https://trycatch.dev"
      // @license-end
    </script>
  </head>
  <body class="post-template tag-blog tag-docker tag-linux tag-self-hosting">
    



  
<header class="m-header with-picture js-header">
  <div class="m-mobile-topbar" data-aos="fade-down">
    <button class="m-icon-button in-mobile-topbar js-open-menu" aria-label="Open menu">
      <span class="icon-menu" aria-hidden="true"></span>
    </button>
      <a href="https://trycatch.dev" class="m-logo in-mobile-topbar">
        <img src="https://trycatch.dev/content/images/2020/08/trycatch-logo-3-2.png" alt="trycatch.dev">
      </a>
    <button class="m-icon-button in-mobile-topbar js-open-search" aria-label="Open search">
      <span class="icon-search" aria-hidden="true"></span>
    </button>
  </div>

  <div class="m-menu js-menu">
    <button class="m-icon-button outlined as-close-menu js-close-menu" aria-label="Close menu">
      <span class="icon-close"></span>
    </button>
    <div class="m-menu__main" data-aos="fade-down">
      <div class="l-wrapper">
        <div class="m-nav js-main-nav">
          <nav class="m-nav__left js-main-nav-left" role="navigation" aria-label="Main menu">
            <ul>
                <li class="only-desktop">
                  <a href="https://trycatch.dev" class="m-logo">
                    <img src="https://trycatch.dev/content/images/2020/08/trycatch-logo-3-2.png" alt="trycatch.dev">
                  </a>
                </li>
                
    <li class="nav-home">
      <a href="https://trycatch.dev/">Home</a>
    </li>
    <li class="nav-about">
      <a href="https://trycatch.dev/about/">About</a>
    </li>
    <li class="nav-arktronic">
      <a href="https://twitter.com/arktronic">@Arktronic</a>
    </li>

              <li class="submenu-option js-submenu-option">
                <button class="m-icon-button in-menu-main more js-toggle-submenu" aria-label="Open submenu">
                  <span class="icon-more" aria-hidden="true"></span>
                </button>
                <div class="m-submenu js-submenu">
                  <div class="l-wrapper in-submenu">
                    <section class="m-recent-articles">
                      <h3 class="m-submenu-title in-recent-articles">Recent articles</h3>
                          <div class="glide js-recent-slider">
                            <div class="glide__track" data-glide-el="track">
                              <div class="glide__slides">
                                <div class="glide__slide">
                                  <a href="/blog/meteorological-meanderings-part-4-creating-interactive-maps/" class="m-recent-article">
                                    <div class="m-recent-article__picture ">
                                        <img src="https://images.unsplash.com/photo-1504807959081-3dafd3871909?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDg2fHxtYXB8ZW58MHx8fHwxNjIwMjY5ODIy&amp;ixlib&#x3D;rb-1.2.1&amp;q&#x3D;80&amp;w&#x3D;2000" loading="lazy" alt="">
                                    </div>
                                    <h3 class="m-recent-article__title js-recent-article-title" title="Meteorological meanderings, part 4: creating interactive maps">
                                      Meteorological meanderings, part 4: creating interactive maps
                                    </h3>
                                    <span class="m-recent-article__date">May 11, 2021</span>
                                  </a>
                                </div>
                                <div class="glide__slide">
                                  <a href="/blog/switching-from-keepass-to-bitwarden-after-14-years/" class="m-recent-article">
                                    <div class="m-recent-article__picture ">
                                        <img src="https://images.unsplash.com/photo-1609358905581-e5381612486e?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MXwxMTc3M3wwfDF8c2VhcmNofDN8fGJhbmslMjB2YXVsdHxlbnwwfHx8&amp;ixlib&#x3D;rb-1.2.1&amp;q&#x3D;80&amp;w&#x3D;2000" loading="lazy" alt="">
                                    </div>
                                    <h3 class="m-recent-article__title js-recent-article-title" title="Switching from KeePass to Bitwarden after 14 years">
                                      Switching from KeePass to Bitwarden after 14 years
                                    </h3>
                                    <span class="m-recent-article__date">Mar 5, 2021</span>
                                  </a>
                                </div>
                                <div class="glide__slide">
                                  <a href="/blog/meteorological-meanderings-part-3-geocoding-and-reverse-geocoding/" class="m-recent-article">
                                    <div class="m-recent-article__picture ">
                                        <img src="https://images.unsplash.com/photo-1599930113854-d6d7fd521f10?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MXwxMTc3M3wwfDF8c2VhcmNofDR8fGdsb2JlfGVufDB8fHw&amp;ixlib&#x3D;rb-1.2.1&amp;q&#x3D;80&amp;w&#x3D;2000" loading="lazy" alt="">
                                    </div>
                                    <h3 class="m-recent-article__title js-recent-article-title" title="Meteorological meanderings, part 3: geocoding and reverse geocoding">
                                      Meteorological meanderings, part 3: geocoding and reverse geocoding
                                    </h3>
                                    <span class="m-recent-article__date">Feb 22, 2021</span>
                                  </a>
                                </div>
                                <div class="glide__slide">
                                  <a href="/blog/meteorological-meanderings-part-2-visualizations-and-long-range-forecasts/" class="m-recent-article">
                                    <div class="m-recent-article__picture ">
                                        <img src="https://images.unsplash.com/photo-1579003593419-98f949b9398f?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MXwxMTc3M3wwfDF8c2VhcmNofDEyfHx3ZWF0aGVyfGVufDB8fHw&amp;ixlib&#x3D;rb-1.2.1&amp;q&#x3D;80&amp;w&#x3D;2000" loading="lazy" alt="">
                                    </div>
                                    <h3 class="m-recent-article__title js-recent-article-title" title="Meteorological meanderings, part 2: visualizations and long-range forecasts">
                                      Meteorological meanderings, part 2: visualizations and long-range forecasts
                                    </h3>
                                    <span class="m-recent-article__date">Feb 1, 2021</span>
                                  </a>
                                </div>
                              </div>
                            </div>
                          </div>
                    </section>
                    <section class="m-tags">
                      <h3 class="m-submenu-title">Tags</h3>
                        <ul>
                            <li>
                              <a href="/tag/3d-modeling/">3D Modeling</a>
                            </li>
                            <li>
                              <a href="/tag/3d-printing/">3D Printing</a>
                            </li>
                            <li>
                              <a href="/tag/docker/">Docker</a>
                            </li>
                            <li>
                              <a href="/tag/github-pages/">GitHub Pages</a>
                            </li>
                            <li>
                              <a href="/tag/linux/">Linux</a>
                            </li>
                            <li>
                              <a href="/tag/meta/">Meta</a>
                            </li>
                            <li>
                              <a href="/tag/python/">Python</a>
                            </li>
                            <li>
                              <a href="/tag/raspberry-pi/">Raspberry Pi</a>
                            </li>
                            <li>
                              <a href="/tag/self-hosting/">Self-hosting</a>
                            </li>
                        </ul>
                    </section>
                  </div>
                </div>
              </li>
            </ul>
          </nav>
          <div class="m-nav__right">
            <button class="m-icon-button in-menu-main js-open-search" aria-label="Open search">
              <span class="icon-search" aria-hidden="true"></span>
            </button>
            <div class="m-toggle-darkmode js-tooltip" data-tippy-content="Toggle dark mode" tabindex="0">
              <label for="toggle-darkmode" class="sr-only">
                Toggle dark mode
              </label>
              <input id="toggle-darkmode" type="checkbox" class="js-toggle-darkmode">
              <div>
                <span class="icon-moon moon" aria-hidden="true"></span>
                <span class="icon-sunny sun" aria-hidden="true"></span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

</header>

<main class="main-wrap">
    

  <section class="m-hero with-picture" data-aos="fade">
    <div class="m-hero__picture in-post"></div>
    </section>
  
  <article>
    <div class="l-content in-post">
        <div class="l-wrapper in-post  js-aos-wrapper" data-aos="fade-up"
          data-aos-delay="300">
          <div
            class="l-post-content  has-subscribe-form js-progress-content">
            <header class="m-heading">
              <h1 class="m-heading__title in-post">Self-hosting a streaming video platform</h1>
              <div class="m-heading__meta">
                <span class="m-heading__meta__time">Sep 12, 2020</span>
              </div>
            </header>
            <div class="pos-relative js-post-content">
              <div class="m-share">
                <div class="m-share__content js-sticky">
                  <a href="https://www.facebook.com/sharer/sharer.php?u=https://trycatch.dev/blog/self-hosting-a-streaming-video-platform/"
                    class="m-icon-button filled in-share" target="_blank" rel="noopener" aria-label="Facebook">
                    <span class="icon-facebook" aria-hidden="true"></span>
                  </a>
                  <a href="https://twitter.com/intent/tweet?text=Self-hosting%20a%20streaming%20video%20platform&url=https://trycatch.dev/blog/self-hosting-a-streaming-video-platform/"
                    class="m-icon-button filled in-share" target="_blank" rel="noopener" aria-label="Twitter">
                    <span class="icon-twitter" aria-hidden="true"></span>
                  </a>
                  <button class="m-icon-button filled in-share progress js-scrolltop" aria-label="Scroll to top">
                    <span class="icon-arrow-top" aria-hidden="true"></span>
                    <svg aria-hidden="true">
                      <circle class="progress-ring__circle js-progress" fill="transparent" r="0" />
                    </svg>
                  </button>
                </div>
              </div>
              <p>Before the pandemic began, I used to host movie nights. Since that activity became dangerous to do in person, I wanted to come up with a virtual alternative. Having set up a <a href="https://trycatch.dev/blog/self-hosting-a-video-chat-system/">self-hosted video chat system</a>, this would be an additional project that'd work alongside with the VPS-hosted, Dockerized, LDAP-secured environment described in the post linked at the beginning of this unnecessarily long sentence.</p><h2 id="background">Background</h2><p>What am I trying to accomplish? I'd like to have a way for everyone attending a virtual movie night to watch the same thing at the same time, with reasonable picture and audio quality, and without having to download and install a bunch of stuff. It'd also be nice to be able to chat (by text) during the movie.</p><p>The text chat part is easily accomplished. Using the self-hosted Jitsi Meet instance, we usually hang out and talk in there before starting the movie. During the movie we simply turn off video and audio and just use the text chat provided by Jitsi Meet. It's not fancy by any means, but it's sufficient.</p><p>As for the movie streaming, that gets a bit more interesting. First, let's start with the obligatory disclaimer: <strong>don't break copyright laws in your country</strong>. For the purpose of providing a realistic example in this post, I'm going to use the movie <em>Night of the Living Dead</em>, downloaded from the <a href="https://archive.org/details/NightOfTheLivingDead-MPEG">Internet Archive</a>, as it is in the public domain.</p><p>There are a number of popular streaming services that a lot of people use, such as YouTube Live, Twitch, and Facebook streaming. Just like in the previous post, however, I wanted to self-host instead because of privacy and the "can I do it well enough?" experimentation factor.</p><h2 id="the-tools">The tools</h2><p>It turns out, there are great open source tools available for doing this kind of streaming setup. On the server side, you need an application to receive streaming data and save it appropriately for serving to viewers. A web application for doing the actual serving of the data stream is needed as well. On the data source side, an application must send the stream to the server. (And on the viewer side, just a web browser is needed.)</p><h3 id="the-server-side">The server side</h3><p>A great choice for receiving the stream, saving it, and being able to serve it is everyone's favorite web server, <a href="https://nginx.org/">nginx</a>, along with <a href="https://github.com/arut/nginx-rtmp-module">nginx-rtmp-module</a> (available in Debian/Ubuntu as <a href="https://packages.debian.org/buster/libnginx-mod-rtmp">libnginx-mod-rtmp</a>). Both can be installed easily in a Docker container. RTMP is a technology that hails from the olden days of Flash video, developed by Macromedia. These days, however, it has become the big standard supported by the major streaming platforms for sending audio and video data with minimal latency.</p><p>To save and later serve the data sent through RTMP, the aforementioned nginx module offers support for <a href="https://en.wikipedia.org/wiki/HTTP_Live_Streaming">HLS</a>, one of the most popular stream serving technologies today. The module has the ability to save an entire stream for later viewing (useful for playing stored videos) as well as the option to only save a minimal amount of cached data during a live event for immediate transmission. I chose the second option because then I don't have to worry about available disk space on the host.</p><p>For serving the HLS stream from the server to viewers, an HTML/JavaScript player application is needed. There are a number of choices, such as <a href="https://github.com/videojs/video.js">Video.js</a>, <a href="https://github.com/mediaelement/mediaelement/">MediaElement.js</a>, and <a href="https://github.com/sampotts/plyr">Plyr</a>. After using Video.js for a while, I decided to switch to Plyr because of its smoother and more polished-looking interface:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://trycatch.dev/content/images/2020/09/image-11.png" class="kg-image" alt="Plyr with a live stream and control bar visible" loading="lazy" width="1554" height="939" srcset="https://trycatch.dev/content/images/size/w600/2020/09/image-11.png 600w, https://trycatch.dev/content/images/size/w1000/2020/09/image-11.png 1000w, https://trycatch.dev/content/images/2020/09/image-11.png 1554w" sizes="(min-width: 720px) 720px"><figcaption>See the nice control bar on the bottom?</figcaption></figure><p>Incidentally, it helps to have a non-movie image or clip playing beforehand to allow everyone to tune in and get comfortable. All a viewer needs is a web browser to enjoy the show.</p><h3 id="the-data-source-side">The data source side</h3><p>Once an RTMP target is configured, the next logical question is, what's the source? The answer, at least with my setup, is <a href="https://obsproject.com/">OBS Studio</a>. This cross-platform, open source software is a popular choice for recording as well as live streaming. It can stream from multiple data sources arranged in a variety of ways on the screen. However, most of its power remains unused in a movie night setup.</p><h2 id="the-server-configuration">The server configuration</h2><p>Now that all the tools are ready, it's time to configure them. For nginx and the RTMP plugin, the configuration is a bit complex, but it can be broken down into parts.</p><figure class="kg-card kg-code-card"><pre><code class="language-nginx">http {
        ##
        # Basic Settings
        ##

        sendfile on;
        tcp_nopush on;
        tcp_nodelay on;
        keepalive_timeout 65;
        types_hash_max_size 2048;

        include /etc/nginx/mime.types;
        default_type application/octet-stream;

        ##
        # Logging Settings
        ##

        access_log /var/log/nginx/access.log;
        error_log /var/log/nginx/error.log;

        ##
        # Gzip Settings
        ##

        gzip on;

        ##
        # Virtual Host Configs
        ##

        server_tokens off;

        server {
                listen 8080;

                location / {
                        root /data/plyr;
                }

                location /livestream {
                        add_header Cache-Control 'no-store, no-cache, must-revalidate, proxy-revalidate, max-age=0';
                        if_modified_since off;
                        expires off;
                        etag off;
                        types {
                                application/vnd.apple.mpegurl m3u8;
                                video/mp2t ts;
                        }
                        alias /data/hls/livestream;
                }
        }
}

rtmp {
        server {
                listen 1935;
                chunk_size 2048;

                on_publish http://127.0.0.1:3000/auth;

                application stream {
                        live on;
                        record off;
                        meta copy;

                        wait_key on;
                        wait_video on;

                        hls on;
                        hls_path /data/hls/livestream;
                        hls_fragment 4;
                        hls_playlist_length 16;
                        hls_sync 100ms;
                }
        }
}</code></pre><figcaption>Excerpt from nginx.conf</figcaption></figure><p>That's a lot of stuff! Let's go from the top down and analyze this configuration file. On the first line is the beginning of the <code>http</code> block. The <code>http</code> block handles the web server configuration for nginx. After some basic settings (most of them default) we have a <code>server</code> block. The <code>listen 8080;</code> directive instructs nginx to listen on port 8080 for HTTP traffic. The <code>location /</code> block beginning on line 37 configures the root website, e.g., <code>http://streaming.example.com/</code>, to get its data from <code>/data/plyr</code>. That location is where I have my Plyr HTML/JS code stored for loading the web player.</p><p>The next block, <code>location /livestream</code> beginning on line 41, is where the HLS data (the playlists and the video streams) will be served, e.g., <code>http://streaming.example.com/livestream</code>. Inside this block are some directives to prevent caching, a MIME type setup block, and the <code>alias</code> directive. You may have noticed that the previous location block used <code>root</code> instead of <code>alias</code>. The two directives are similar, but there is an important difference: <code>alias</code> will use a directory path as-is, while <code>root</code> will append the <code>location</code> path to the one specified in the <code>root</code> directive. For example:</p><pre><code class="language-nginx">location /asdf {
	# Files will be served at {domain}/asdf from the /www/asdf directory
	root /www;
}

location /fdsa {
	# Files will be served at {domain}/fdsa from the /www directory
	alias /www;
}</code></pre><p>Starting on line 55 is the <code>rtmp</code> block. This block comes from the RTMP module and is responsible for nginx's RTMP and HLS processing. The <code>listen 1935;</code> directive on line 57 tells nginx to listen on port 1935 for RTMP connections. While IANA still <a href="https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml?search=1935">defines this port</a> as "macromedia-fcs", it is in fact the standard RTMP port.</p><p>The <code>on_publish</code> directive on line 60 is what allows me to perform authentication on incoming RTMP streams. The way this works is, nginx sends a POST to the specified URL with form data containing connection details. If it gets an HTTP 200 response, then it allows the stream to proceed. If it gets an HTTP 401, then it prevents the stream from being received and processed. I wrote a little Python script to let me authenticate streams against LDAP, and it's been working well.</p><p>The <code>application stream</code> block on line 62 creates an RTMP endpoint named "stream", such that a tool like OBS will be able to connect to <code>rtmp://streaming.example.com/stream</code>. The specifics of the various directives in this block can be found on <a href="https://github.com/arut/nginx-rtmp-module/wiki/Directives">the module's GitHub wiki</a>, but there are a few important ones I'd like to point out. First, <code>hls_path /data/hls/livestream;</code> on line 71: as you may have noticed, the path here is the same as the one for the <code>/livestream</code> location up above. This is not a coincidence; you must have a way to access the HLS data being output by the RTMP module via the web.</p><p>The other directives I'd like to mention are <code>hls_fragment 4;</code> and <code>hls_playlist_length 16;</code>. I've played around with these values a <em>lot</em> in my quest to decrease the latency between starting a movie and everyone actually seeing it. Unfortunately, when the values are too low, nginx seems to have trouble serving the HLS data, and you end up with half-functioning streams and periods of HTTP 404s for no apparent reason. If you search online, you'll find lots of different values. Cloudflare, for example, <a href="https://blog.cloudflare.com/building-cloudflare-tv-from-scratch/">uses 1 and 4</a>, respectively. I was not able to get a stable stream with them set that low.</p><h2 id="the-source-side-configuration">The source side configuration</h2><p>I am by no means an expert in using OBS, but a basic configuration is pretty easy. For configuring streaming, simply set the server and key ("my-key" as an example) under the Streaming settings:</p><figure class="kg-card kg-image-card"><img src="https://trycatch.dev/content/images/2020/09/image-12.png" class="kg-image" alt="Screenshot of OBS Settings screen with Stream tab selected and values entered" loading="lazy" width="983" height="758" srcset="https://trycatch.dev/content/images/size/w600/2020/09/image-12.png 600w, https://trycatch.dev/content/images/2020/09/image-12.png 983w" sizes="(min-width: 720px) 720px"></figure><p>After that, add your video source(s), arrange them as needed, and you're ready to go. Here's a summary GIF of this process:</p><figure class="kg-card kg-image-card"><img src="https://trycatch.dev/content/images/2020/09/obs-movie-usage.gif" class="kg-image" alt="Animated GIF of the process of starting movie streaming in OBS" loading="lazy" width="1390" height="1072"></figure><p>Romero's cult classic is being played using the VLC Video Source in the above GIF. That source becomes available only when VLC is detected on your machine. If you do not have it installed, the Media Source option should work as well.</p><p>Once streaming begins, the web player should be able to access the HLS stream, in this example, under <code>http://streaming.example.com/livestream/my-key.m3u8</code>.</p><p>If you run into issues, the first thing to do is check the nginx logs and your browser debug console. Between those two, you will likely be able to find any misconfiguration that may have happened. And once everything is working, you can share a virtual movie night experience, too!</p>
                <section class="m-tags in-post">
                  <h3 class="m-submenu-title">Tags</h3>
                  <ul>
                      <li>
                        <a href="/tag/docker/" title="Docker">Docker</a>
                      </li>
                      <li>
                        <a href="/tag/linux/" title="Linux">Linux</a>
                      </li>
                      <li>
                        <a href="/tag/self-hosting/" title="Self-hosting">Self-hosting</a>
                      </li>
                  </ul>
                </section>
            </div>
          </div>
        </div>
          <section class="m-subscribe-section">
            <div class="l-wrapper in-post">
              <div class="m-subscribe-section__content">
                <div class="m-subscribe-section__text">
                  <h4 class="m-subscribe-section__title">Subscribe to our newsletter</h4>
                  <p class="m-subscribe-section__description">
                    Get the latest posts delivered right to your inbox.
                  </p>
                </div>
                <div class="m-subscribe-section__form">
                  
<div class="m-subscribe-section__form">
  <form data-members-form="subscribe" id="newsletter-form" class="m-subscribe-section__container">
    <div class="m-subscribe__form">
      <div class="pos-relative">
        <label for="newsletter-input" class="sr-only">Your email address</label>
        <input data-members-email id="newsletter-input" class="m-input in-subscribe-section" type="email"
          placeholder="Your email address" required />
      </div>
      <button id="newsletter-button" class="m-button primary block" type="submit">Subscribe</button>
    </div>
    <div class="m-subscribe__success">
      <header class="m-heading no-margin">
        <img src="/assets/images/success.png?v=d450aebd8c" alt="Success!" class="m-subscribe__success_icon">
        <p class="m-heading__description in-newsletter-form">
          Now check your inbox and click the link to confirm your subscription.
        </p>
      </header>
    </div>
    <p class="m-subscribe__invalid m-small-text">
      Please enter a valid email address
    </p>
    <p class="m-subscribe__error m-small-text">
      Oops! There was an error sending the email, please try later.
    </p>
  </form>
</div>
                </div>
              </div>
            </div>
          </section>
        <section class="m-recommended">
          <div class="l-wrapper in-recommended">
            <h3 class="m-section-title in-recommended">Recommended for you</h3>
            <div class="m-recommended-articles">
              <div class="m-recommended-slider glide js-recommended-slider">
                <div class="glide__track" data-glide-el="track">
                  <div class="glide__slides">
                    
    <div class="m-recommended-slider__item glide__slide">
  <article class="m-article-card  post tag-blog tag-python tag-raspberry-pi tag-3d-printing tag-3d-modeling">
    <div class="m-article-card__picture">
      <a href="/blog/raspberry-pi-powered-webcam/" class="m-article-card__picture-link" aria-hidden="true" tabindex="-1"></a>
        <img class="m-article-card__picture-background" src="https://images.unsplash.com/photo-1587919057555-d728ff5beac3?ixlib&#x3D;rb-1.2.1&amp;q&#x3D;80&amp;fm&#x3D;jpg&amp;crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;w&#x3D;2000&amp;fit&#x3D;max&amp;ixid&#x3D;eyJhcHBfaWQiOjExNzczfQ" loading="lazy" alt="">
    </div>
      <div class="m-article-card__info no-tag">
      <a href="/blog/raspberry-pi-powered-webcam/" class="m-article-card__info-link" aria-label="Raspberry Pi-powered webcam">
        <div>
          <h2 class="m-article-card__title js-article-card-title " title="Raspberry Pi-powered webcam">
            Raspberry Pi-powered webcam
          </h2>
        </div>
        <div class="m-article-card__timestamp">
          <span>Aug 30, 2020</span>
          <span>&bull;</span>
          <span>7 min read</span>
        </div>
      </a>
    </div>
  </article>
    </div>
    <div class="m-recommended-slider__item glide__slide">
  <article class="m-article-card  post tag-blog tag-docker tag-linux tag-self-hosting">
    <div class="m-article-card__picture">
      <a href="/blog/self-hosting-a-video-chat-system/" class="m-article-card__picture-link" aria-hidden="true" tabindex="-1"></a>
        <img class="m-article-card__picture-background" src="https://images.unsplash.com/photo-1588196749597-9ff075ee6b5b?ixlib&#x3D;rb-1.2.1&amp;q&#x3D;80&amp;fm&#x3D;jpg&amp;crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;w&#x3D;2000&amp;fit&#x3D;max&amp;ixid&#x3D;eyJhcHBfaWQiOjExNzczfQ" loading="lazy" alt="">
    </div>
      <div class="m-article-card__info no-tag">
      <a href="/blog/self-hosting-a-video-chat-system/" class="m-article-card__info-link" aria-label="Self-hosting a video chat system">
        <div>
          <h2 class="m-article-card__title js-article-card-title " title="Self-hosting a video chat system">
            Self-hosting a video chat system
          </h2>
        </div>
        <div class="m-article-card__timestamp">
          <span>Sep 10, 2020</span>
          <span>&bull;</span>
          <span>4 min read</span>
        </div>
      </a>
    </div>
  </article>
    </div>
    <div class="m-recommended-slider__item glide__slide">
  <article class="m-article-card  post tag-blog tag-meta tag-python tag-github-pages">
    <div class="m-article-card__picture">
      <a href="/blog/boo-a-static-ghost/" class="m-article-card__picture-link" aria-hidden="true" tabindex="-1"></a>
        <img class="m-article-card__picture-background" src="https://images.unsplash.com/photo-1476283721796-dd935b062838?ixlib&#x3D;rb-1.2.1&amp;q&#x3D;80&amp;fm&#x3D;jpg&amp;crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;w&#x3D;2000&amp;fit&#x3D;max&amp;ixid&#x3D;eyJhcHBfaWQiOjExNzczfQ" loading="lazy" alt="">
    </div>
      <div class="m-article-card__info no-tag">
      <a href="/blog/boo-a-static-ghost/" class="m-article-card__info-link" aria-label="Boo! A static Ghost!">
        <div>
          <h2 class="m-article-card__title js-article-card-title " title="Boo! A static Ghost!">
            Boo! A static Ghost!
          </h2>
        </div>
        <div class="m-article-card__timestamp">
          <span>Aug 28, 2020</span>
          <span>&bull;</span>
          <span>5 min read</span>
        </div>
      </a>
    </div>
  </article>
    </div>
                  </div>
                </div>
                <div data-glide-el="controls" class="glide__arrows js-controls">
                  <button data-glide-dir="<" class="m-icon-button filled in-recommended-articles glide-prev" aria-label="Previous">
                    <span class="icon-arrow-left" aria-hidden="true"></span>
                  </button>
                  <button data-glide-dir=">" class="m-icon-button filled in-recommended-articles glide-next" aria-label="Next">
                    <span class="icon-arrow-right" aria-hidden="true"></span>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </section>
    </div>
  </article>
</main>



    
<div class="m-search js-search" role="dialog" aria-modal="true" aria-label="Search">
  <button class="m-icon-button outlined as-close-search js-close-search" aria-label="Close search">
    <span class="icon-close" aria-hidden="true"></span>
  </button>
  <div class="m-search__content">
    <form class="m-search__form">
      <div class="pos-relative">
        <span class="icon-search m-search-icon" aria-hidden="true"></span>
        <label for="search-input" class="sr-only">
          Type to search
        </label>
        <input id="search-input" type="text" class="m-input in-search js-input-search" placeholder="Type to search">
      </div>
    </form>
    <div class="js-search-results hide"></div>
    <p class="m-not-found align-center hide js-no-results">
      No results for your search, please try with something else.
    </p>
  </div>
</div>

    
<footer class="m-footer">
  <div class="m-footer__content">
    <p class="m-footer-copyright">
      <span>trycatch.dev &copy; 2021</span>
    </p>

    <nav class="m-footer-social">
        <a href="https://twitter.com/arktronic" target="_blank" rel="noopener" aria-label="Twitter">
          <span class="icon-twitter" aria-hidden="true"></span>
        </a>
      <a href="https://trycatch.dev/rss.xml" aria-label="RSS">
        <span class="icon-rss" aria-hidden="true"></span>
      </a>
    </nav>
    <p class="m-footer-copyright jslicense">
      <a href="/assets/html/javascript.html?v=d450aebd8c" rel="jslicense">JavaScript license information</a>
    </p>
  </div>
</footer>

    <div class="m-alert success subscribe js-alert" data-notification="subscribe">
  Great! You&#x27;ve successfully subscribed.
  <button class="m-alert__close js-notification-close" aria-label="Close">
    <span class="icon-close"></span>
  </button>
</div>

<div class="m-alert success signup js-alert" data-notification="signup">
  Great! Next, complete checkout for full access.
  <button class="m-alert__close js-notification-close" aria-label="Close">
    <span class="icon-close"></span>
  </button>
</div>

<div class="m-alert success signin js-alert" data-notification="signin">
  Welcome back! You&#x27;ve successfully signed in.
  <button class="m-alert__close js-notification-close" aria-label="Close">
    <span class="icon-close"></span>
  </button>
</div>

<div class="m-alert success checkout js-alert" data-notification="checkout">
  Success! Your account is fully activated, you now have access to all content.
  <button class="m-alert__close js-notification-close" aria-label="Close">
    <span class="icon-close"></span>
  </button>
</div>
    <script crossorigin="anonymous" src="https://polyfill.io/v3/polyfill.min.js?features=IntersectionObserver%2CPromise%2CArray.prototype.includes%2CString.prototype.endsWith%2CString.prototype.startsWith%2CObject.assign%2CNodeList.prototype.forEach"></script>
    <script defer src="/assets/js/manifest.js?v=d450aebd8c"></script>
    <script defer src="/assets/js/vendor/content-api.min.js?v=d450aebd8c"></script>
    <script defer src="/assets/js/vendor.js?v=d450aebd8c"></script>
    <script defer src="/assets/js/app.js?v=d450aebd8c"></script>
    <script defer src="/assets/js/prism.js?v=d450aebd8c"></script>

      <script defer src="/assets/js/post.js?v=d450aebd8c"></script>


    <script type="text/javascript">
    document.body.classList.add('line-numbers');
    document.querySelectorAll('a.in-share').forEach(a => {
        a.classList.add('js-tooltip');
        a.dataset.tippyContent = 'Share';
    });
</script>
<script type="text/javascript">
    if (document.location.hostname == 'trycatch.dev') {
        window.goatcounter = {
            endpoint: 'https://count-trycatch.arktronic.com/count',
        }
        var s = document.createElement('script');
        s.type = 'text/javascript';
        s.src = '//count-trycatch.arktronic.com/count.js';
        document.getElementsByTagName('head')[0].appendChild(s);
	}
</script>
  </body>
</html>
